var o=class{static EL_WRAPPER="wrapper";static EL_ITEMS="items";static EL_ITEM="item";static EL_ITEM_ACTIVE="item-active";static EL_INDICATOR="indicator";static EL_INDICATOR_ACTIVE="indicator-active";static BTN_PREV="btn-prev";static BTN_NEXT="btn-next";static BTN_HIDE="btn-hide";static TRANSITION_NONE="transition-none";static SWIPE_THRESHOLD=20;static#a=[];static checkSupportPassiveEvents(){let t=!1;try{let e=Object.defineProperty({},"passive",{get(){return t=!0,!1}});window.addEventListener("testPassiveListener",null,e),window.removeEventListener("testPassiveListener",null,e)}catch{t=!1}return t}#s;#t;#n;constructor(t,e={},s="itc-slider-"){this.#t={prefix:s,el:t,elWrapper:t.querySelector(`.${s}${this.constructor.EL_WRAPPER}`),elItems:t.querySelector(`.${s}${this.constructor.EL_ITEMS}`),elListItem:t.querySelectorAll(`.${s}${this.constructor.EL_ITEM}`),btnPrev:t.querySelector(`.${s}${this.constructor.BTN_PREV}`),btnNext:t.querySelector(`.${s}${this.constructor.BTN_NEXT}`),btnClassHide:s+this.constructor.BTN_HIDE,exOrderMin:0,exOrderMax:0,exItemMin:null,exItemMax:null,exTranslateMin:0,exTranslateMax:0,direction:"next",intervalId:null,isSwiping:!1,swipeX:0,swipeY:0},this.#n=null,this.#s={loop:!0,direction:"next",autoplay:!1,interval:5e3,refresh:!0,swipe:!0,...e},this.#p(),this.#L()}static getInstance(t){let e=this.#a.find(s=>s.target===t);return e?e.instance:null}static getOrCreateInstance(t,e={},s="itc-slider-"){let i=typeof t=="string"?document.querySelector(t):t,n=this.getInstance(i);if(n)return n;let r=new this(i,e,s);return this.#a.push({target:i,instance:r}),r}static createInstances(){document.querySelectorAll('[data-slider="itc-slider"]').forEach(t=>{let{dataset:e}=t,s={};Object.keys(e).forEach(i=>{if(i==="slider")return;let n=e[i];n=Number.isNaN(Number(n))?n:Number(n),n=n==="true"?!0:n,n=n==="false"?!1:n,s[i]=n}),this.getOrCreateInstance(t,s)})}slideNext(){this.#t.direction="next",this.#i()}slidePrev(){this.#t.direction="prev",this.#i()}slideTo(t){this.#u(t)}reset(){this.#m()}get autoplay(){return{start:()=>{this.#s.autoplay=!0,this.#e()},stop:()=>{this.#e("stop"),this.#s.autoplay=!1}}}dispose(){this.#M();let t=this.#t.prefix+this.constructor.TRANSITION_NONE,e=this.#t.prefix+this.constructor.EL_ITEM_ACTIVE;this.#e("stop"),this.#t.elItems.classList.add(t),this.#t.elItems.style.transform="",this.#t.elListItem.forEach(n=>{n.style.transform="",n.classList.remove(e)});let s=`${this.#t.prefix}${this.constructor.EL_INDICATOR_ACTIVE}`;document.querySelectorAll(`.${s}`).forEach(n=>{n.classList.remove(s)}),this.#t.elItems.offsetHeight,this.#t.elItems.classList.remove(t);let i=this.constructor.instances.findIndex(n=>n.target===this.#t.el);this.constructor.instances.splice(i,1)}#f(t){if(this.#t.isMoving&&t.preventDefault(),!(t.target.closest(".itc-slider-btn")||t.target.closest(".itc-slider-indicators")))return;let e=this.#t.prefix+this.constructor.BTN_PREV,s=this.#t.prefix+this.constructor.BTN_NEXT;if(this.#e("stop"),t.target.closest(`.${e}`)||t.target.closest(`.${s}`))this.#t.direction=t.target.closest(`.${e}`)?"prev":"next",this.#i();else if(t.target.dataset.slideTo){let i=parseInt(t.target.dataset.slideTo,10);this.#u(i)}this.#s.loop&&this.#e()}#v(){this.#e("stop")}#I(){this.#e()}#x(){if(this.#s.loop){if(this.#t.isBalancing)return;this.#t.isBalancing=!0,window.requestAnimationFrame(()=>{this.#r(!1)})}}#g(){this.#s.loop&&(this.#t.isBalancing=!1)}#E(t){t.preventDefault()}#b(){document.visibilityState==="hidden"?this.#e("stop"):document.visibilityState==="visible"&&this.#s.loop&&this.#e()}#o(t){this.#t.isMoving=!1,this.#e("stop");let e=t.type.search("touch")===0?t.touches[0]:t;this.#t.swipeX=e.clientX,this.#t.swipeY=e.clientY,this.#t.isSwiping=!0,this.#t.isTouchMoving=!1}#c(t){if(!this.#t.isSwiping)return;let e=t.type.search("touch")===0?t.changedTouches[0]:t,s=this.#t.elWrapper.getBoundingClientRect(),i=e.clientX<s.left?s.left:e.clientX;i=i>s.right?s.right:i;let n=this.#t.swipeX-i;if(n===0){this.#t.isSwiping=!1;return}if(!this.#s.loop){let h=this.#t.activeItems[0]===1&&n<=0,c=this.#t.activeItems[this.#t.activeItems.length-1]&&n>=0;(h||c)&&(n=0)}let r=n/this.#t.width*100,a=this.#t.prefix+this.constructor.TRANSITION_NONE;if(this.#t.elItems.classList.remove(a),r>this.constructor.SWIPE_THRESHOLD){this.#t.direction="next";let h=0;for(;h<=Math.floor(Math.abs(r)-this.constructor.SWIPE_THRESHOLD)/100;)this.move(),h+=1}else if(r<-this.constructor.SWIPE_THRESHOLD){this.#t.direction="prev";let h=0;for(;h<=Math.floor(Math.abs(r)-this.constructor.SWIPE_THRESHOLD)/100;)this.#i(),h+=1}else this.#t.direction="none",this.#i();this.#t.isSwiping=!1,this.#s.loop&&this.#e(),this.#t.isBalancing=!1}#l(t){if(!this.#t.isSwiping)return;this.#t.isMoving=!0;let e=t.type.search("touch")===0?t.changedTouches[0]:t,s=this.#t.swipeX-e.clientX,i=this.#t.swipeY-e.clientY,r=(this.#t.prevPosX?this.#t.prevPosX:e.clientX)>e.clientX?"next":"prev";if(this.#t.prevPosX=e.clientX,!this.#t.isTouchMoving){if(Math.abs(i)>Math.abs(s)||Math.abs(s)===0){this.#t.isSwiping=!1;return}this.#t.isTouchMoving=!0}if(t.preventDefault(),!this.#s.loop){let c=this.#t.activeItems[0]===1&&s<=0,l=this.#t.activeItems[this.#t.activeItems.length-1]&&s>=0;(c||l)&&(s/=4)}let a=this.#t.prefix+this.constructor.TRANSITION_NONE;this.#t.elItems.classList.add(a);let h=this.#t.translate-s;this.#t.elItems.style.transform=`translate3D(${h}px, 0px, 0.1px)`,this.#s.loop&&(this.#t.direction=s>0?"next":"prev",this.#t.direction=r,window.requestAnimationFrame(()=>{this.#r(!0)}))}#L(){this.#t.events={click:[this.#t.el,this.#f.bind(this),!0],mouseenter:[this.#t.el,this.#v.bind(this),!0],mouseleave:[this.#t.el,this.#I.bind(this),!0],transitionstart:[this.#t.elItems,this.#x.bind(this),this.#s.loop],transitionend:[this.#t.elItems,this.#g.bind(this),this.#s.loop],touchstart:[this.#t.el,this.#o.bind(this),this.#s.swipe],mousedown:[this.#t.el,this.#o.bind(this),this.#s.swipe],touchend:[document,this.#c.bind(this),this.#s.swipe],mouseup:[document,this.#c.bind(this),this.#s.swipe],touchmove:[this.#t.el,this.#l.bind(this),this.#s.swipe],mousemove:[this.#t.el,this.#l.bind(this),this.#s.swipe],dragstart:[this.#t.el,this.#E.bind(this),!0],visibilitychange:[document,this.#b.bind(this),!0]},Object.keys(this.#t.events).forEach(t=>{if(this.#t.events[t][2]){let e=this.#t.events[t][0],s=this.#t.events[t][1];if(t==="touchstart"||t==="touchmove"){let i=this.constructor.checkSupportPassiveEvents()?{passive:!1}:!1;e.addEventListener(t,s,i)}else e.addEventListener(t,s)}}),this.#n=new ResizeObserver(()=>{window.requestAnimationFrame(this.#m.bind(this))}),this.#n.observe(this.#t.elWrapper)}#M(){Object.keys(this.#t.events).forEach(t=>{if(this.#t.events[t][2]){let e=this.#t.events[t][0],s=this.#t.events[t][1];e.removeEventListener(t,s),this.#n.disconnect()}})}#e(t){if(this.#s.autoplay){if(t==="stop"){clearInterval(this.#t.intervalId),this.#t.intervalId=null;return}this.#t.intervalId===null&&(this.#t.intervalId=setInterval(()=>{this.#t.direction=this.#s.direction==="prev"?"prev":"next",this.#i()},this.#s.interval))}}#r(t=!1){if(!this.#t.isBalancing&&!t)return;let e=this.#t.elWrapper.getBoundingClientRect(),s=e.width/this.#t.countActiveItems/2,i=this.#t.elListItem.length;if(this.#t.direction==="next"){if(this.#t.exItemMin.getBoundingClientRect().right<e.left-s){let r=this.#t.els.find(h=>h.el===this.#t.exItemMin);r.order=this.#t.exOrderMin+i;let a=this.#t.exTranslateMin+i*this.#t.width;r.translate=a,this.#t.exItemMin.style.transform=`translate3D(${a}px, 0px, 0.1px)`,this.#h()}}else if(this.#t.exItemMax.getBoundingClientRect().left>e.right+s){let r=this.#t.els.find(h=>h.el===this.#t.exItemMax);r.order=this.#t.exOrderMax-i;let a=this.#t.exTranslateMax-i*this.#t.width;r.translate=a,this.#t.exItemMax.style.transform=`translate3D(${a}px, 0px, 0.1px)`,this.#h()}t||window.requestAnimationFrame(()=>{this.#r(!1)})}#d(){let t=this.#t.prefix+this.constructor.EL_ITEM_ACTIVE;this.#t.activeItems.forEach((e,s)=>{e?this.#t.elListItem[s].classList.add(t):this.#t.elListItem[s].classList.remove(t);let i=this.#t.el.querySelectorAll(`.${this.#t.prefix}${this.constructor.EL_INDICATOR}`);i.length&&e?i[s].classList.add(`${this.#t.prefix}${this.constructor.EL_INDICATOR_ACTIVE}`):i.length&&!e&&i[s].classList.remove(`${this.#t.prefix}${this.constructor.EL_INDICATOR_ACTIVE}`)})}#i(){if(this.#t.direction==="none"){let s=this.#t.translate;this.#t.elItems.style.transform=`translate3D(${s}px, 0px, 0.1px)`;return}let t=this.#t.direction==="next"?-this.#t.width:this.#t.width,e=this.#t.translate+t;if(!this.#s.loop){let s=this.#t.width*(this.#t.elListItem.length-this.#t.countActiveItems);if(Math.round(e*100)<-Math.round(s*100)||Math.round(e*100)>0)return;this.#t.btnPrev&&(this.#t.btnPrev.classList.remove(this.#t.btnClassHide),this.#t.btnNext.classList.remove(this.#t.btnClassHide)),this.#t.btnPrev&&Math.round(e*100)===-Math.round(s*100)?this.#t.btnNext.classList.add(this.#t.btnClassHide):this.#t.btnPrev&&Math.round(e*100)===0&&this.#t.btnPrev.classList.add(this.#t.btnClassHide)}this.#t.direction==="next"?this.#t.activeItems=[...this.#t.activeItems.slice(-1),...this.#t.activeItems.slice(0,-1)]:this.#t.activeItems=[...this.#t.activeItems.slice(1),...this.#t.activeItems.slice(0,1)],this.#d(),this.#t.translate=e,this.#t.elItems.style.transform=`translate3D(${e}px, 0px, 0.1px)`}#u(t){let e=this.#t.activeItems.reduce((s,i,n)=>{let r=i?t-n:s;return Math.abs(r)<Math.abs(s)?r:s},this.#t.activeItems.length);if(e!==0){this.#t.direction=e>0?"next":"prev";for(let s=0;s<Math.abs(e);s++)this.#i()}}#p(){this.#t.els=[],this.#t.translate=0,this.#t.activeItems=[],this.#t.isBalancing=!1;let t=parseFloat(getComputedStyle(this.#t.elItems).gap)||0;this.#t.width=this.#t.elListItem[0].getBoundingClientRect().width+t;let e=this.#t.elWrapper.getBoundingClientRect().width;if(this.#t.countActiveItems=Math.round(e/this.#t.width),this.#t.elListItem.forEach((s,i)=>{s.style.transform="",this.#t.activeItems.push(i<this.#t.countActiveItems?1:0),this.#t.els.push({el:s,index:i,order:i,translate:0})}),this.#t.countActiveItems===this.#t.elListItem.length?(this.#t.btnPrev&&this.#t.btnPrev.classList.add(this.#t.btnClassHide),this.#t.btnNext&&this.#t.btnNext.classList.add(this.#t.btnClassHide)):(this.#t.btnPrev&&this.#t.btnPrev.classList.remove(this.#t.btnClassHide),this.#t.btnNext&&this.#t.btnNext.classList.remove(this.#t.btnClassHide)),this.#s.loop){let s=this.#t.elListItem.length-1,i=-(s+1)*this.#t.width;this.#t.elListItem[s].style.transform=`translate3D(${i}px, 0px, 0.1px)`,this.#t.els[s].order=-1,this.#t.els[s].translate=i,this.#h()}else this.#t.btnPrev&&this.#t.btnPrev.classList.add(this.#t.btnClassHide);this.#d(),this.#e()}#m(){let t=this.#t.prefix+this.constructor.TRANSITION_NONE,e=parseFloat(getComputedStyle(this.#t.elItems).gap)||0,s=this.#t.elListItem[0].getBoundingClientRect().width+e,i=this.#t.elWrapper.getBoundingClientRect().width,n=Math.round(i/s);s===this.#t.width&&n===this.#t.countActiveItems||(this.#e("stop"),this.#t.elItems.classList.add(t),this.#t.elItems.style.transform="translate3D(0px, 0px, 0.1px)",this.#p(),window.requestAnimationFrame(()=>{this.#t.elItems.classList.remove(t)}))}#h(){let t=this.#t.els.map(n=>n.el),e=this.#t.els.map(n=>n.order);this.#t.exOrderMin=Math.min(...e),this.#t.exOrderMax=Math.max(...e);let s=e.indexOf(this.#t.exOrderMin),i=e.indexOf(this.#t.exOrderMax);this.#t.exItemMin=t[s],this.#t.exItemMax=t[i],this.#t.exTranslateMin=this.#t.els[s].translate,this.#t.exTranslateMax=this.#t.els[i].translate}};o.createInstances();document.addEventListener("DOMContentLoaded",()=>{o.getOrCreateInstance(".itc-slider",{loop:!1,swipe:!1})});
/**
 * @class ItcSlider
 * @version 1.0.2
 * @author https://github.com/itchief
 * @copyright Alexander Maltsev 2020 - 2024
 * @license MIT (https://github.com/itchief/ui-components/blob/master/LICENSE)
 * @tutorial https://itchief.ru/javascript/slider
 */
